詳細設計 (Detailed Design)
========================

1. データフロー
---------------

1.  **Upload**: ユーザーがファイルをドロップまたは選択 -> `FilePicker` が検知。
2.  **Save**: `upload()` メソッドにより、サーバー側の `assets/uploads/` にファイルが保存される。
3.  **Process**: 保存されたファイルパスを `process_image()` 関数に渡す。
4.  **OpenCV Pipeline**:
    *   `cv2.imdecode`: バイト列から画像をデコード（日本語パス対策）。
    *   `cvtColor`: グレースケール化。
    *   `GaussianBlur`: ノイズ除去。
    *   `threshold`: 2値化（白黒反転）。
    *   `findContours` & `boundingRect`: 文字領域（バウンディングボックス）の特定。
    *   `resize`: アスペクト比維持リサイズ。
    *   `pad`: 28x28の中心に配置。
5.  **Predict**:
    *   正規化 (0.0 - 1.0)
    *   `model.predict()` 実行。
    *   `argmax` で数字を特定。

2. AIモデル仕様 (CNN)
---------------------

TensorFlow/Kerasを使用。

*   **入力**: (Batch, 28, 28, 1) - グレースケール画像
*   **構造**:
    1.  `Conv2D(32, 3x3, ReLU)`
    2.  `MaxPooling((2,2))`
    3.  `Flatten`
    4.  `Dense(128, ReLU)`
    5.  `Dense(10, Softmax)`
*   **出力**: 10次元の確率ベクトル

3. エラーハンドリング
---------------------
*   **画像読み込み失敗**: ファイルが画像でない、破損している場合はエラーメッセージを表示。
*   **文字検出失敗**: 画像内に文字らしい輪郭が見つからない場合（真っ白な画像など）は、「文字が見つかりませんでした」と表示。
